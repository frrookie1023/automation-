
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>instruction &#8212; Automation 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to Automation’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="instruction">
<h1>instruction<a class="headerlink" href="#instruction" title="Permalink to this heading">¶</a></h1>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this heading">¶</a></h2>
<p>You need to install the following libraries and dependencies to use this project:</p>
<ul class="simple">
<li><p>[Selenium](<a class="reference external" href="https://selenium-python.readthedocs.io/">https://selenium-python.readthedocs.io/</a>): Used for web automation.</p></li>
<li><p>[Pandas](<a class="reference external" href="https://pandas.pydata.org/">https://pandas.pydata.org/</a>): Used for data manipulation.</p></li>
<li><p>[IPython Widgets](<a class="reference external" href="https://ipywidgets.readthedocs.io/">https://ipywidgets.readthedocs.io/</a>): Used for interactive widgets in IPython.</p></li>
<li><p>[Tkinter](<a class="reference external" href="https://docs.python.org/3/library/tkinter.html">https://docs.python.org/3/library/tkinter.html</a>): Used for creating GUI applications.</p></li>
<li><p>[PyQt5](<a class="reference external" href="https://pypi.org/project/PyQt5/">https://pypi.org/project/PyQt5/</a>): Used for creating GUI applications.</p></li>
<li><p>[Requests](<a class="reference external" href="https://docs.python-requests.org/en/master/">https://docs.python-requests.org/en/master/</a>): Used for making HTTP requests.</p></li>
<li><p>[Beautiful Soup](<a class="reference external" href="https://www.crummy.com/software/BeautifulSoup/">https://www.crummy.com/software/BeautifulSoup/</a>): Used for web scraping.</p></li>
</ul>
<p>To use these libraries, first install it using pip:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(.venv)</span> <span class="gp">$ </span>pip install selenium pandas ipywidgets requests beautifulsoup4
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="kn">from</span> <span class="nn">selenium.common.exceptions</span> <span class="kn">import</span> <span class="n">NoSuchElementException</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QPushButton</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">zipfile</span> <span class="c1">#extract zip file</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
</pre></div>
</div>
<p>You may also need to install specific drivers or additional software depending on your use case. For example, to use Selenium, you’ll need to download and configure ChromeDriver
(<a class="reference external" href="https://sites.google.com/chromium.org/driver/">https://sites.google.com/chromium.org/driver/</a>).</p>
</section>
<section id="setup-downloading">
<h2>Setup downloading<a class="headerlink" href="#setup-downloading" title="Permalink to this heading">¶</a></h2>
<p>The following part is the setup for the chromeDriver and downloading path:</p>
<ul class="simple">
<li><p>setting up the directory path for activating the browser</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">PATH</span> <span class="o">=</span> <span class="s2">&quot;/Users/frrookie521/Desktop/civil/cee495/cee495/Google\ Chrome\ for\ Testing.app&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>setting up the downloading path:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">download_path</span> <span class="o">=</span> <span class="s2">&quot;/Users/frrookie521/Desktop/civil/cee495/automationtesting/&quot;</span>
</pre></div>
</div>
</section>
<section id="setting-up-the-chromedriver-environment">
<h2>Setting up the chromedriver environment<a class="headerlink" href="#setting-up-the-chromedriver-environment" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">--disable-dev-shm-usage</span></code> is using for solving shared memory issue</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">download.default_directory</span></code> is setting up the downloading path</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">download.default_directory:</span> <span class="pre">False</span></code> is automated downloading files without user configuration</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">download.directory_upgrade:</span> <span class="pre">True</span></code> is ensures that Chrome will always use the downloading path</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">safebrowsing.enabled:</span> <span class="pre">True</span></code> is safe browsing</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-dev-shm-usage&#39;</span><span class="p">)</span>
<span class="n">prefs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;download.default_directory&#39;</span><span class="p">:</span> <span class="n">download_path</span><span class="p">,</span>
    <span class="s1">&#39;download.prompt_for_download&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;download.directory_upgrade&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;safebrowsing.enabled&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_experimental_option</span><span class="p">(</span><span class="s1">&#39;prefs&#39;</span><span class="p">,</span> <span class="n">prefs</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>importing the excels that showing the lists of variables and their urls</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">excel_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;VariableSources_2.xlsx&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>initiate the google chrome as driver with the option set up from chrome_options:</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">driver.set_window_size</span></code>: set up the window size for the driver</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">set_window_size</span><span class="p">(</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">excel_file.iloc[1:,</span> <span class="pre">2].tolist()</span></code>: extracting urls from the excel file</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">unique</span></code>: extracting the unique urls</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">urls</span> <span class="o">=</span> <span class="n">excel_file</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">unique</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">url</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
<span class="n">zipfiles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;file1.zip&#39;</span><span class="p">,</span> <span class="s1">&#39;file2.zip&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="converting-txt-file-to-csv">
<h2>Converting_TXT_file_to_CSV<a class="headerlink" href="#converting-txt-file-to-csv" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="text_to_csv">
<span class="sig-name descname"><span class="pre">text_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#text_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a csv file that contains data from the txt file</p>
<dl class="field-list simple">
<dt class="field-odd">Input_filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>txt file that is opened by driver</p>
</dd>
<dt class="field-even">Output_filename<span class="colon">:</span></dt>
<dd class="field-even"><p>csv file that is created by the code itself</p>
</dd>
</dl>
</dd></dl>

<ul class="simple">
<li><p>using <code class="code docutils literal notranslate"><span class="pre">headlines</span></code> to read all the lines from txt file and create a list. Each element will be the string the contain all the data in the line.</p></li>
<li><p>After open the <code class="code docutils literal notranslate"><span class="pre">output_filename</span></code> with write mode, the loop keep iterating for each line from the line list.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">line.strip().split()</span></code> remove any leading whitespace for each line, and then splitting them into a list of individual string.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">','.join(fields)</span></code> takes a list of individual and combine them into a single string as csv file format.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">text_to_csv</span><span class="p">(</span><span class="n">input_filename</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">txt</span><span class="p">:</span> <span class="c1">#open the file</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">txt</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csv_file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">csv_line</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
            <span class="n">csv_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">csv_line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="interacting-with-urls-and-filtering-the-data">
<h2>Interacting with URLs and filtering the data<a class="headerlink" href="#interacting-with-urls-and-filtering-the-data" title="Permalink to this heading">¶</a></h2>
<p>In this codebase, we have designed a modular approach to interact with various URLs, each corresponding to a different data source. This modularity allows us to tailor our interactions to the specific requirements of each data source. For clarity, we’ve created distinct functions, each designed to handle a unique URL. These functions encompass the necessary HTML interactions, data extraction procedures, and any specific steps needed to retrieve data from each URL.</p>
<p>Common code for interacting button with each function:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">driver.get()</span></code> is asking the driver to open the webpage base on the unique url</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">find_element</span></code> is the main part of the automation. It using for interacting with different kind of buttons.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">time.sleep()</span></code> is using for delaying the following command. Sometimes, the webpage is not been fully loaded  due to the network environment</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">EC.visibility_of_element_located()</span></code> is another kind of approach to dealing with slow loaded webpage. It will start the interaction until html is visible</p></li>
</ul>
</div></blockquote>
<dl>
<dt>The following are the functions name:</dt><dd><blockquote>
<div><ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_geographic">
<span class="sig-name descname"><span class="pre">census_geographic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_geographic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table S0701 from the US Census.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>After downloading the file, the code will extract the zip files. By setting up the maximum attempts, the code will extract once for each attempts until the files have been successfully extracted. The reason is that sometimes, the zip file may not be downloaded properly due to the internet.</p></li>
<li><p>The csv file name will be <code class="code docutils literal notranslate"><span class="pre">f'ACSST5Y{year}.S0701-Data.csv'</span></code>, where the data is from 2017 to 2021. After doing the filtering, we save the data as <code class="code docutils literal notranslate"><span class="pre">f'{year}.csv'</span></code>.</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_demographics">
<span class="sig-name descname"><span class="pre">census_demographics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_demographics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table DP05 from the US Census.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as previous</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="tamu_umr_report">
<span class="sig-name descname"><span class="pre">tamu_umr_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#tamu_umr_report" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the 2021 Urban Mobility Report and Appendices.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The downloaded file will be excel table. The table is labeled inconsistently. Therefore the following work is cleaning and reorganizing the data.</p></li>
<li><p>we keep the necessary columns in the table and convert it to CSV file <code class="code docutils literal notranslate"><span class="pre">'umr.csv'</span></code> and delete the previous excel spreadsheet.</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_data">
<span class="sig-name descname"><span class="pre">census_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the business applications by County.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The downloaded data is excel spreadsheet. Convert it to CSV file version</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_survey">
<span class="sig-name descname"><span class="pre">census_survey</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_survey" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the County business patterns.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>download and extracting the data with the same approach as previous did.</p></li>
<li><p>Using <code class="code docutils literal notranslate"><span class="pre">'text_to_CSV'</span></code> function to convert the txt file into CSV</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="cnbc_business">
<span class="sig-name descname"><span class="pre">cnbc_business</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cnbc_business" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the business ranking.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>downloading the business ranking data from the CNBC website. However, different with previous method, we let the code to search for the exacted year data’s url. By doing this way, it will reduce the complication of interaction process. For the year 2009 and 2013, table’s URL is different comparing to other years.</p></li>
<li><p>For other years, we created URL format <code class="code docutils literal notranslate"><span class="pre">f&quot;https://www.cnbc.com/{year}/{month}/{day}/americas-top-states-for-business.html&quot;</span></code>. Because these reports are been published between August and October, from 10th to 24th. Therefore, We set up the year is <code class="code docutils literal notranslate"><span class="pre">year</span> <span class="pre">&gt;=</span> <span class="pre">2014</span></code>. Month is <code class="code docutils literal notranslate"><span class="pre">in</span> <span class="pre">range(6,8)</span></code>, and the day is <code class="code docutils literal notranslate"><span class="pre">in</span> <span class="pre">range(10,24)</span></code>. By trying different month and day, if the url is existing, then the <code class="code docutils literal notranslate"><span class="pre">response.status_code</span></code> will be 200.</p></li>
<li><p>After successfully login to the webpage, we try to extract the data from original html file and convert it to CSV file</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="realtor_research">
<span class="sig-name descname"><span class="pre">realtor_research</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#realtor_research" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the Residential data.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>After successfully downloading the CSV table, we clean and filter the data and save as <code class="code docutils literal notranslate"><span class="pre">realtor.csv</span></code>.</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="taxfoundation">
<span class="sig-name descname"><span class="pre">taxfoundation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taxfoundation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the State Business Tax Climate Index.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>we extract the data from the official website and convert it to the CSV file.</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_construction">
<span class="sig-name descname"><span class="pre">census_construction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_construction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the Building Permits Survey (BPS).</p>
<blockquote>
<div><ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="zillow">
<span class="sig-name descname"><span class="pre">zillow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#zillow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the Housing data.</p>
<blockquote>
<div><ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="climate_hazard">
<span class="sig-name descname"><span class="pre">climate_hazard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#climate_hazard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the National Risk Index.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as working on census_demographics</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_DP02">
<span class="sig-name descname"><span class="pre">census_DP02</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_DP02" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table DP02.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as working on census_demographics</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_S2301">
<span class="sig-name descname"><span class="pre">census_S2301</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_S2301" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table S2031.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as working on census_demographics</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_B25104">
<span class="sig-name descname"><span class="pre">census_B25104</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_B25104" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table B25104.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as working on census_demographics</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_S0802">
<span class="sig-name descname"><span class="pre">census_S0802</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_S0802" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table S0802.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as working on census_demographics</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="census_B14004">
<span class="sig-name descname"><span class="pre">census_B14004</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#census_B14004" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the table B14004.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>The process is same as working on census_demographics</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="library">
<span class="sig-name descname"><span class="pre">library</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#library" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the binary data.</p>
<blockquote>
<div><blockquote>
<div><ul class="simple">
<li><p>After <code class="code docutils literal notranslate"><span class="pre">driver.get(url)</span></code>, we access the online source. Since the html is dynamically changing, we need to scroll down the webpage to find the html that we want by using <code class="code docutils literal notranslate"><span class="pre">window.scrollBy(0,</span> <span class="pre">1000);</span></code></p></li>
<li><p>After downloading, we extract the zip file to get CSV file. However, after the extracting there will be a new folder that contains two different CSV files. What we do is trying to move these CSV files out from the new folder to our downloading path folder.</p></li>
</ul>
</div></blockquote>
<ul>
<li><dl class="py function">
<dt class="sig sig-object py" id="interstate">
<span class="sig-name descname"><span class="pre">interstate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#interstate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
</div></blockquote>
<p>Open and download the interstate highway data.</p>
<blockquote>
<div><ul>
<li><p>we setup a key for each html</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">years</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2022</span><span class="p">)</span>
<span class="n">download_xpath_years</span> <span class="o">=</span> <span class="p">{</span>
   <span class="mi">2015</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[3]/tbody/tr[39]/td[3]/a&#39;</span><span class="p">,</span>
   <span class="mi">2016</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[4]/tbody/tr[39]/td[3]/a&#39;</span><span class="p">,</span>
   <span class="mi">2017</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[3]/tbody/tr[39]/td[3]/a&#39;</span><span class="p">,</span>
   <span class="mi">2018</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[3]/tbody/tr[39]/td[3]/a&#39;</span><span class="p">,</span>
   <span class="mi">2019</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[3]/tbody/tr[39]/td[3]/a&#39;</span><span class="p">,</span>
   <span class="mi">2020</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[3]/tbody/tr[39]/td[3]/a&#39;</span><span class="p">,</span>
   <span class="mi">2021</span><span class="p">:</span> <span class="s1">&#39;//*[@id=&quot;fullpage&quot;]/table[3]/tbody/tr[33]/td[3]/a&#39;</span>
    <span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Based on each year URL and html, we will download xls files. Renaming the file as <code class="code docutils literal notranslate"><span class="pre">f&quot;{year}_interstate.xls</span></code></p></li>
<li><p>After downloading, we clean and filter the data, converting to <code class="code docutils literal notranslate"><span class="pre">f'{year}_interstate.csv</span></code></p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</section>
<section id="target">
<h2>Target<a class="headerlink" href="#target" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><p>we setup notation for each unique URLs.</p></li>
</ul>
</div></blockquote>
</section>
<section id="check-target">
<h2>Check_target<a class="headerlink" href="#check-target" title="Permalink to this heading">¶</a></h2>
<p>we save the notation for each target. These notation names will be the function name which will be operated in previous code.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">target_formats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div></blockquote>
<p>Then, checking whether each url from the excel sheet <code class="code docutils literal notranslate"><span class="pre">VariableSources_2.xlsx</span></code> matched with our target urls. If matched, the output will return True</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">return</span> <span class="nb">any</span><span class="p">(</span><span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span> <span class="k">for</span> <span class="nb">format</span> <span class="ow">in</span> <span class="n">target_formats</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>We convert each key to an interaction function that can be operated automatically by the code.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">check_target</span><span class="p">(</span><span class="n">unique</span><span class="p">):</span>
        <span class="n">interaction_function</span> <span class="o">=</span> <span class="n">target</span><span class="p">[</span><span class="n">url</span><span class="p">]</span>
        <span class="n">interaction_function</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Automation</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">instruction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setup-downloading">Setup downloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-the-chromedriver-environment">Setting up the chromedriver environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#converting-txt-file-to-csv">Converting_TXT_file_to_CSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interacting-with-urls-and-filtering-the-data">Interacting with URLs and filtering the data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#target">Target</a></li>
<li class="toctree-l2"><a class="reference internal" href="#check-target">Check_target</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Automation’s documentation!</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Guangyan Li.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/usage.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>